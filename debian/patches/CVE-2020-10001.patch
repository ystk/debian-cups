commit efbea1742bd30f842fbbfb87a473e5c84f4162f9
Author: Michael R Sweet <msweet@msweet.org>
Date:   Mon Feb 1 15:02:32 2021 -0500

    Fix a buffer (read) overflow in ippReadIO (CVE-2020-10001)

Index: cups-1.7.5/cups/ipp.c
===================================================================
--- cups-1.7.5.orig/cups/ipp.c	2021-10-25 16:53:44.796396651 +0200
+++ cups-1.7.5/cups/ipp.c	2021-10-25 16:54:45.268441956 +0200
@@ -3106,7 +3106,8 @@
   unsigned char		*buffer,	/* Data buffer */
 			string[IPP_MAX_TEXT],
 					/* Small string buffer */
-			*bufptr;	/* Pointer into buffer */
+			*bufptr,	/* Pointer into buffer */
+			*bufend;	/* End of buffer */
   ipp_attribute_t	*attr;		/* Current attribute */
   ipp_tag_t		tag;		/* Current tag */
   ipp_tag_t		value_tag;	/* Current value tag */
@@ -3672,6 +3673,7 @@
 		}
 
                 bufptr = buffer;
+                bufend = buffer + n;
 
 	       /*
 	        * text-with-language and name-with-language are composite
@@ -3685,8 +3687,7 @@
 
 		n = (bufptr[0] << 8) | bufptr[1];
 
-		if ((bufptr + 2 + n) >= (buffer + IPP_BUF_SIZE) ||
-		    n >= sizeof(string))
+                if ((bufptr + 2 + n + 2) > bufend || n >= (int)sizeof(string))
 		{
 		  _cupsSetError(IPP_STATUS_ERROR_INTERNAL,
 		                _("IPP language length overflows value."), 1);
@@ -3713,7 +3714,7 @@
                 bufptr += 2 + n;
 		n = (bufptr[0] << 8) | bufptr[1];
 
-		if ((bufptr + 2 + n) >= (buffer + IPP_BUF_SIZE))
+		if ((bufptr + 2 + n) > bufend)
 		{
 		  _cupsSetError(IPP_STATUS_ERROR_INTERNAL,
 		                _("IPP string length overflows value."), 1);
